


***********Table to merger all data*********************	
	
create or replace table weatherRestaurants.ods.yelp_climate (
	yelp_id int autoincrement primary Key,
	address text null,
    	categories text,
	bikeparking varchar(255),
	AcceptsCR_Cards varchar(50),
	price_range varchar,
	parking_garage text,
	parking_street text,
	parking_validated text,
	parking_lot text,
	parking_valet text,
	is_open varchar,
	latitude varchar,
	longitude varchar,
	restaurant_name text,
    	business_review_count int,
    	rest_stars int,
	city varchar(100),
	state varchar,
    	postal_code text,
	hours_Friday varchar,
	hours_Monday varchar,
	hours_Saturday varchar,
	hours_Sunday varchar,
	hours_Thursday varchar,
	hours_Tuesday varchar,
	hours_Wednesday varchar,
	average_stars int,
	user_compliment_count int null,
	compliment_cool int,
	compliment_cute int,
	compliment_funny int,
	compliment_hot int,
	compliment_list int,
	compliment_more int,
	compliment_note int,
	compliment_photos int,
	compliment_plain int,
	compliment_profile int,
	compliment_writer int,
	elite string,
	fans int,
	friends string, 
	user_name string,
	review_count number, 
  	yelping_since timestamp,
	cool number,
	review_date timestamp,	
   	funny number,
	stars number,
	text string,
	useful number, 
	call_to_action_enabled varchar, 
	covid_banner varchar,  
	grubhub_enabled varchar,  
	request_a_quote_enabled varchar,  
	temporary_closed_untill varchar, 
    	virtual_service_offered varchar, 
    	delivery_or_takeout varchar, 
	highlights  varchar, 
	tip_compliment_count number, 
	compliment_date timestamp, 
	compliment_text varchar,
	checkin_date string,
	clim_date string, 
	min int,
	max int,
	normal_min int,
	normal_max int,
	precipitation varchar,
	precipitation_normal double,
	user_id varchar references users(user_id),
    	clim_id int references climate(clim_id),
	business_id varchar references business(business_id),
	rev_id int references reviews(rev_id),
	cov_id int references covid(cov_id ),
	tip_id int references tip(tip_id),
	chk_id int references checkin(chk_id)
	
	);
	
	
********Merger all tables **********************	   			
   


INSERT INTO weatherRestaurants.ods.yelp_climate (
	address ,
    	categories ,
	bikeparking ,
	AcceptsCR_Cards,
	price_range ,
	parking_garage ,
	parking_street ,
	parking_validated ,
	parking_lot ,
	parking_valet ,
	is_open ,
	latitude ,
	longitude ,
	restaurant_name ,
    	business_review_count,
    	rest_stars ,
	city ,
	state ,
    	postal_code ,
	hours_Friday ,
	hours_Monday ,
	hours_Saturday ,
	hours_Sunday ,
	hours_Thursday ,
	hours_Tuesday ,
	hours_Wednesday ,
	average_stars ,
	user_compliment_count,
	compliment_cool,
	compliment_cute ,
	compliment_funny,
	compliment_hot ,
	compliment_list ,
	compliment_more ,
	compliment_note ,
	compliment_photos ,
	compliment_plain ,
	compliment_profile,
	compliment_writer ,
	elite ,
	fans ,
	friends , 
	user_name ,
	review_count , 
  	yelping_since,
	cool ,
	review_date ,	
   	funny ,
	stars ,
	text ,
	useful , 
	call_to_action_enabled , 
	covid_banner ,  
	grubhub_enabled ,  
	request_a_quote_enabled ,  
	temporary_closed_untill , 
    	virtual_service_offered , 
    	delivery_or_takeout , 
	highlights , 
	tip_compliment_count, 
	compliment_date , 
	compliment_text ,
	checkin_date ,
	clim_date , 
	min ,
	max ,
	normal_min ,
	normal_max ,
	precipitation ,
	precipitation_normal ,
	user_id ,
    	clim_id ,
	business_id ,
	rev_id ,
	cov_id,
	tip_id,
	chk_id
	
  
	)
    
SELECT
	b.address ,
    	b.categories ,
	b.bikeparking ,
	b.AcceptsCR_Cards,
	b.price_range ,
	b.parking_garage ,
	b.parking_street ,
	b.parking_validated ,
	b.parking_lot ,
	b.parking_valet ,
	b.is_open ,
	b.latitude ,
	b.longitude ,
	b.restaurant_name ,
    	b.review_count AS business_review_count,
    	b.stars AS rest_stars  ,
	b.city ,
	b.state ,
    	b.postal_code ,
	b.hours_Friday ,
	b.hours_Monday ,
	b.hours_Saturday ,
	b.hours_Sunday ,
	b.hours_Thursday ,
	b.hours_Tuesday ,
	b.hours_Wednesday ,
	u.average_stars ,
	b.user_compliment_count,
	u.compliment_cool,
	u.compliment_cute ,
	u.compliment_funny,
	u.compliment_hot ,
	u.compliment_list ,
	u.compliment_more ,
	u.compliment_note ,
	u.compliment_photos ,
	u.compliment_plain ,
	u.compliment_profile,
	u.compliment_writer ,
	u.elite ,
	u.fans ,
	u.friends , 
	u.user_name ,
	u.review_count , 
  	u.yelping_since,
	r.cool ,
	r.date AS review_date ,
   	r.funny ,
	r.stars ,
	r.text ,
	r.useful , 
	c.call_to_action_enabled , 
	c.covid_banner ,  
	c.grubhub_enabled ,  
	c.request_a_quote_enabled ,  
	c.temporary_closed_untill , 
    	c.virtual_service_offered , 
    	c.delivery_or_takeout , 
	c.highlights , 
	t.compliment_count AS tip_compliment_count , 
	t.date AS compliment_date , 
	t.text AS compliment_text ,
	k.date AS checkin_date ,
	p.date AS clim_date , 
	p.min ,
	p.max ,
	p.normal_min ,
	p.normal_max ,
	p.precipitation ,
	p.precipitation_normal ,
	u.user_id ,
    	p.clim_id ,
	b.business_id ,
	r.rev_id ,
	c.cov_id,
	t.tip_id,
	k.chk_id
	
  
FROM reviews r 

FULL JOIN business b
       ON b.business_id = r.business_id
FULL JOIN users u 
        ON u.user_id = r.user_id
FULL JOIN climate p 
        ON p.date = r.date 
FULL JOIN covid c 
        ON c.business_id = b.business_id
FULL JOIN tip t 
        ON t.user_id = u.user_id
FULL JOIN checkin k 
        ON k.business_id = b.business_id ;





